openapi: 3.0.1
info:
  description: 本地视频理解插件，提供视频分析、状态查询和结果获取功能
  title: 视频理解端插件
  version: v1
paths:
  /video_submit:
    post:
      operationId: video_submit
      summary: 提交视频进行理解
      description: 提交本地视频路径进行理解分析，返回 job_id
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - path
              properties:
                path:
                  type: string
                  description: 本地视频文件路径
                  example: '/path/to/video.mp4'
                options:
                  type: object
                  properties:
                    need_asr:
                      type: boolean
                      default: false
                      description: 是否需要语音识别
                    need_ocr:
                      type: boolean
                      default: false
                      description: 是否需要文字识别
                  default: {}
      responses:
        '200':
          description: 成功提交，返回 job_id
          content:
            application/json:
              schema:
                type: object
                properties:
                  job_id:
                    type: string
                    description: 任务ID
        default:
          description: 请求参数错误
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: object
                    properties:
                      message:
                        type: string
                      code:
                        type: string
      x-functionName: video_submit

  /video_status:
    post:
      operationId: video_status
      summary: 查询任务状态
      description: 根据 job_id 查询视频理解任务的状态和进度
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - job_id
              properties:
                job_id:
                  type: string
                  description: 任务ID
      responses:
        '200':
          description: 返回任务状态
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum: [queued, running, succeeded, failed]
                    description: 任务状态
                  progress:
                    type: number
                    minimum: 0.0
                    maximum: 1.0
                    description: 任务进度（0.0-1.0）
        default:
          description: 任务不存在
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: object
                    properties:
                      message:
                        type: string
                      code:
                        type: string
      x-functionName: video_status

  /video_result:
    post:
      operationId: video_result
      summary: 获取理解结果
      description: 根据 job_id 获取视频理解的结构化结果
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - job_id
              properties:
                job_id:
                  type: string
                  description: 任务ID
      responses:
        '200':
          description: 返回结构化结果
          content:
            application/json:
              schema:
                type: object
                properties:
                  caption:
                    type: string
                    description: 视频描述
                  tags:
                    type: array
                    items:
                      type: string
                    description: 视频标签列表
                  timeline:
                    type: array
                    items:
                      type: object
                      properties:
                        start_sec:
                          type: number
                          description: 片段开始时间（秒）
                        end_sec:
                          type: number
                          description: 片段结束时间（秒）
                        summary:
                          type: string
                          description: 片段摘要
        default:
          description: 任务不存在或未完成
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: object
                    properties:
                      message:
                        type: string
                      code:
                        type: string
      x-functionName: video_result
